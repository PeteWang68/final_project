<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Kee-Young Shin" />


<title>final_project</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.8.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-1.39.2/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 52px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 57px;
  margin-top: -57px;
}

.section h2 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h3 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h4 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h5 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h6 {
  padding-top: 57px;
  margin-top: -57px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">Change in Hate Crime Incidents</a>
</li>
<li>
  <a href="voting.html">Trump Election and Hate Crime</a>
</li>
<li>
  <a href="Situation_in_2016.html">Predicting Hate Crime </a>
</li>
<li>
  <a href="https://petewang.shinyapps.io/shiny/">Shiny</a>
</li>
<li>
  <a href="mailto:ks3663@cumc.columbia.edu">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/PeteWang68/final_project">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">final_project</h1>
<h4 class="author"><em>Kee-Young Shin</em></h4>
<h4 class="date"><em>December 5, 2018</em></h4>

</div>


<pre class="r"><code>library(tidyverse)
library(readxl)
library(plotly)</code></pre>
<div id="data-import" class="section level1">
<h1>Data import</h1>
<div id="import-hate-crime-incident-count-from-2005-to-2017" class="section level2">
<h2>import hate crime incident count from 2005 to 2017</h2>
<pre class="r"><code>hate_offenses_2017 = read_xls(&quot;./data/table-1.xls&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(table_1 == &quot;Total&quot;) %&gt;% 
  mutate(table_1 = str_replace(table_1, &quot;Total&quot;, &quot;2017&quot;))

hate_offenses_2016 = read_xls(&quot;./data/2016_hatecrime.xls&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(table_1 == &quot;Total&quot;) %&gt;% 
  mutate(table_1 = str_replace(table_1, &quot;Total&quot;, &quot;2016&quot;)) %&gt;% 
  select(1:5)

hate_offenses_2015 = read_xls(&quot;./data/2015_hatecrime.xls&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(table_1 == &quot;Total&quot;) %&gt;% 
  mutate(table_1 = str_replace(table_1, &quot;Total&quot;, &quot;2015&quot;))
    
hate_offenses_2014 = read_xls(&quot;./data/2014_hatecrime.xls&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(table_1 == &quot;Total&quot;) %&gt;% 
  mutate(table_1 = str_replace(table_1, &quot;Total&quot;, &quot;2014&quot;)) %&gt;% 
  select(1:5)

hate_offenses_2013 = read_xls(&quot;./data/2013_hatecrime.xls&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(table_1 == &quot;Total&quot;) %&gt;% 
  mutate(table_1 = str_replace(table_1, &quot;Total&quot;, &quot;2013&quot;)) %&gt;% 
  select(1:5)

hate_offenses_2012 = read_xls(&quot;./data/2011_hatecrime.xls&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(table_1 == &quot;Total&quot;) %&gt;% 
  mutate(table_1 = str_replace(table_1, &quot;Total&quot;, &quot;2012&quot;))

hate_offenses_2011 = read_xls(&quot;./data/2011_hatecrime.xls&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(table_1 == &quot;Total&quot;) %&gt;% 
  mutate(table_1 = str_replace(table_1, &quot;Total&quot;, &quot;2011&quot;))

hate_offenses_2010 = read_xls(&quot;./data/2010_hatecrime.xls&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(table_1 == &quot;Total&quot;) %&gt;% 
  mutate(table_1 = str_replace(table_1, &quot;Total&quot;, &quot;2010&quot;))

hate_offenses_2009 = read_xls(&quot;./data/2009_hatecrime.xls&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(table_1 == &quot;Total&quot;) %&gt;% 
  mutate(table_1 = str_replace(table_1, &quot;Total&quot;, &quot;2009&quot;))

hate_offenses_2008 = read_xls(&quot;./data/2008_hatecrime.xls&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(table_1 == &quot;Total&quot;) %&gt;% 
  mutate(table_1 = str_replace(table_1, &quot;Total&quot;, &quot;2008&quot;))

hate_offenses_2007 = read_xls(&quot;./data/2007_hatecrime.xls&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(table_1 == &quot;Total&quot;) %&gt;% 
  mutate(table_1 = str_replace(table_1, &quot;Total&quot;, &quot;2007&quot;))

hate_offenses_2006 = read_xls(&quot;./data/2006_hatecrime.xls&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(table_1 == &quot;Total&quot;) %&gt;% 
  mutate(table_1 = str_replace(table_1, &quot;Total&quot;, &quot;2006&quot;))

hate_offenses_2005 = read_xls(&quot;./data/2005_hatecrime.xls&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(table_1 == &quot;Total&quot;) %&gt;% 
  mutate(table_1 = str_replace(table_1, &quot;Total&quot;, &quot;2005&quot;))

# aggregate data for all years
hatecrime_count_df = rbind(hate_offenses_2017, hate_offenses_2016, hate_offenses_2015, 
                           hate_offenses_2014, hate_offenses_2013, hate_offenses_2012,
                           hate_offenses_2011, hate_offenses_2010, hate_offenses_2009,
                           hate_offenses_2008, hate_offenses_2007, hate_offenses_2006,
                           hate_offenses_2005) %&gt;% 
  select(1:3) 
  
colnames(hatecrime_count_df) = c(&quot;year&quot;, &quot;total_incidents&quot;, &quot;total_offenses&quot;)</code></pre>
</div>
<div id="importing-hate-crime-and-predictors-dataset" class="section level2">
<h2>importing hate crime and predictors dataset</h2>
<pre class="r"><code># data in 2016
income = read_csv(&quot;./data/Income.csv&quot;) %&gt;% 
  janitor::clean_names()</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   Location = col_character(),
##   `Median Annual Household Income` = col_character()
## )</code></pre>
<pre class="r"><code>unemployment = read_csv(&quot;./data/Unemployment.csv&quot;) %&gt;% 
  janitor::clean_names()</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   Location = col_character(),
##   Unemployed = col_double()
## )</code></pre>
<pre class="r"><code>education = read_csv(&quot;./data/Educational_level.csv&quot;) %&gt;% 
  janitor::clean_names()</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   Location = col_character(),
##   share_population_with_high_school_degree = col_double()
## )</code></pre>
<pre class="r"><code>ctizenship = read_csv(&quot;./data/Ctizenship.csv&quot;) %&gt;% 
  janitor::clean_names()</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   Location = col_character(),
##   Citizen = col_double(),
##   `Non-Citizen` = col_double(),
##   Total = col_integer()
## )</code></pre>
<pre class="r"><code>race = read_csv(&quot;./data/Race.csv&quot;) %&gt;% 
  janitor::clean_names()</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   Location = col_character(),
##   White = col_double(),
##   Black = col_character(),
##   Hispanic = col_double(),
##   Asian = col_character(),
##   `American Indian/Alaska Native` = col_character(),
##   `Native Hawaiian/Other Pacific Islander` = col_character(),
##   `Two Or More Races` = col_character(),
##   Total = col_integer(),
##   Footnotes = col_integer()
## )</code></pre>
<pre class="r"><code>vote = read_csv(&quot;./data/Vote.csv&quot;) %&gt;% 
  janitor::clean_names()</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   Location = col_character(),
##   share_voters_voted_trump = col_character()
## )</code></pre>
<pre class="r"><code>crime_rate = read_excel(&quot;./data/2016.xls&quot;,  range = cell_rows(3:54)) %&gt;%
  janitor::clean_names() %&gt;%
  filter(participating_state != &quot;Total&quot;) %&gt;%
  select(location = participating_state, population_covered,       total_number_of_incidents_reported) %&gt;%
  mutate(crime_rate = total_number_of_incidents_reported/population_covered*100000)

crime_rate_10_days = read_csv(&quot;./data/hate_crime_10days.csv&quot;) %&gt;%
  janitor::clean_names()%&gt;%
  select(location = state, hate_crime_10_day = hate_crimes_per_100k_splc)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   state = col_character(),
##   hate_crimes_per_100k_splc = col_double()
## )</code></pre>
<pre class="r"><code>ctizenship =
  ctizenship %&gt;% 
  select(location, non_citizen)

race =
  race %&gt;% 
  select(location, white)

crime_rate =
  crime_rate %&gt;% 
  select(location, crime_rate)

merge_data = 
  merge(income, unemployment, by = &quot;location&quot;) %&gt;% 
  merge(., education, by = &quot;location&quot;) %&gt;% 
  merge(., ctizenship, by = &quot;location&quot;) %&gt;% 
  merge(., race, by = &quot;location&quot;) %&gt;% 
  merge(., vote, by = &quot;location&quot;) %&gt;%
  merge(., crime_rate, by = &quot;location&quot;) %&gt;%
  merge(., crime_rate_10_days, by = &quot;location&quot;) %&gt;%
  filter(location != &quot;United States&quot;) %&gt;% 
  rename(state = location, share_unemployed = unemployed, share_non_citizen = non_citizen, share_white = white)</code></pre>
</div>
</div>
<div id="dataset-for-annual-report-in-state-division" class="section level1">
<h1>dataset for annual report in state division</h1>
<pre class="r"><code>#list
df = list.files(path = &quot;./annual&quot;)
#function
read_data = function(x){read_excel(str_c(&quot;./annual/&quot;, x),  range = &quot;A3:E54&quot;)%&gt;%
    mutate(year = x)}
#map
hate_crime = map(df, read_data)%&gt;%
  bind_rows()%&gt;%
  janitor::clean_names()%&gt;%
  select(-agencies_submitting_incident_reports, -agencies_submitting_incident_reports_2,-agencies_submitting_incident_reports_3)%&gt;%
  mutate(year = str_replace(year, &quot;.xls&quot;, &quot;&quot;))%&gt;%
  select(year, everything())
#set na to 0
hate_crime[is.na(hate_crime)]=0

#complete the final dataset
hate_crime = hate_crime%&gt;%
  mutate(total_incident = total_number_of_incidents_reported + total_number_of_incidents_reported_2)%&gt;%
  select(year, state = participating_state, population = population_covered, total_incident)%&gt;%
  filter(state != &quot;Total&quot;) %&gt;%
  mutate(annualprop = total_incident/population*100000)%&gt;%
  mutate(year = str_replace(year, &quot;.xls&quot;, &quot;&quot;))%&gt;%
  filter(state!=&quot;Guam1&quot;)</code></pre>
<p>do the further cleaning of the merge data</p>
<pre class="r"><code>merge_data = merge_data %&gt;%
  mutate(median_annual_household_income = str_replace(median_annual_household_income, &quot;,&quot;, &quot;&quot;)) %&gt;%
  mutate(median_annual_household_income = gsub(&quot;\\$&quot;, &quot;&quot;,median_annual_household_income )) %&gt;%
mutate(median_annual_household_income = as.numeric(median_annual_household_income)) %&gt;%
  select(state, median_income = median_annual_household_income, everything())</code></pre>
</div>
<div id="explore-the-data" class="section level1">
<h1>Explore the data</h1>
<div id="plot-change-in-number-of-hate-crimes-over-time" class="section level2">
<h2>plot change in number of hate crimes over time</h2>
<pre class="r"><code>hatecrime_count_df %&gt;% 
  ggplot(aes(x = year, y = total_incidents)) + geom_line(group = 1, color = &quot;blue&quot;)</code></pre>
<p><img src="final_project_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="building-the-map-of-hate-crime-rate-based-on-2016" class="section level2">
<h2>Building the Map of hate crime rate based on 2016</h2>
<pre class="r"><code>map_data_2016 = merge_data %&gt;%
  rbind(c(&quot;Hawaii&quot;,71223,   0.034, 0.904,   0 ,0.81, &#39;33.1%&#39;, 0 ,0)) %&gt;% 
  as.tibble() %&gt;% 
  arrange(state)

map_data&lt;-map_data_2016 %&gt;%         
  mutate(
         state = as.factor(state),
         code = state.abb[state],
         code = c(code[1:8],&#39;DC&#39;,code[9:50]),
         hover = with(map_data_2016, paste(state,&#39;&lt;br&gt;&#39; ,&quot;share for trump&quot;,share_voters_voted_trump)),
         crime_rate = as.numeric(crime_rate)
         ) %&gt;% 
  select(code, crime_rate, hover)

l &lt;- list(color = toRGB(&quot;grey&quot;), width = 1)
g &lt;- list(
  scope = &#39;usa&#39;,
  projection = list(type = &#39;albers usa&#39;),
  showlakes = F
)


plot_geo(map_data, locationmode = &#39;USA-states&#39;) %&gt;%
  add_trace(
    z = ~ crime_rate, text = ~hover, locations = ~code,
    color = ~ crime_rate, colors = &#39;Reds&#39;,marker = list(line = l)
  ) %&gt;%
  colorbar(title = &quot;Hate crime rate &quot;) %&gt;%
  layout(
    title = &#39;Hate crime rate in 2016 all over U.S. &#39;,
    geo = g
  )</code></pre>
<div id="htmlwidget-858163e6bc15035c8327" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-858163e6bc15035c8327">{"x":{"visdat":{"102957e4d2dc0":["function () ","plotlyVisDat"]},"cur_data":"102957e4d2dc0","attrs":{"102957e4d2dc0":{"locationmode":"USA-states","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"z":{},"text":{},"locations":{},"color":{},"colors":"Reds","marker":{"line":{"color":"rgba(190,190,190,1)","width":1}},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"mapType":"geo","scene":{"zaxis":{"title":"crime_rate"}},"geo":{"domain":{"x":[0,1],"y":[0,1]},"scope":"usa","projection":{"type":"albers usa"},"showlakes":false},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5},"title":"Hate crime rate in 2016 all over U.S. "},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"colorbar":{"title":"Hate crime rate ","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(255,245,240,1)"],["0.0276381501808651","rgba(255,240,233,1)"],["0.0291350844947359","rgba(255,240,233,1)"],["0.0331604121426014","rgba(255,239,232,1)"],["0.0368979147901257","rgba(255,239,231,1)"],["0.0462814299368298","rgba(255,237,229,1)"],["0.0578460434229595","rgba(255,235,226,1)"],["0.0656081980995609","rgba(255,234,224,1)"],["0.0781357869275092","rgba(255,232,221,1)"],["0.0848442765868411","rgba(255,231,220,1)"],["0.0863228382646843","rgba(255,230,219,1)"],["0.0928963955658705","rgba(254,229,218,1)"],["0.0994352614608665","rgba(254,228,216,1)"],["0.112143104206994","rgba(254,226,213,1)"],["0.126997908109786","rgba(254,223,209,1)"],["0.13139983231937","rgba(254,222,207,1)"],["0.137574915231338","rgba(254,220,205,1)"],["0.154340895505053","rgba(254,215,198,1)"],["0.174590813352765","rgba(254,209,190,1)"],["0.178296121547066","rgba(254,208,189,1)"],["0.194468249085437","rgba(254,203,183,1)"],["0.239264076066464","rgba(252,190,165,1)"],["0.272379802797908","rgba(252,180,152,1)"],["0.311517159113247","rgba(253,167,138,1)"],["1","rgba(103,0,13,1)"]],"showscale":true,"locationmode":"USA-states","z":[1.3808898651561,1.48937264916067,3.34805113558664,0.420514815262585,2.37241981189183,1.88413647670102,2.96383119359633,1.57552267964897,16.8827165024884,1.06807949849217,0.474675629191675,0,1.60414463443326,0.897081333757898,2.71343987643412,0.545959163539177,1.89091504080132,4.65270703981678,0.730244567331498,3.00417806063783,0.614980901518787,5.89066918001885,4.05170339094064,2.29774753161092,1.19565328787573,1.44502572063679,1.91929738361381,1.67873732959462,1.39453031198704,2.19578565995122,3.15335468296094,4.50639387962382,3.01436916852553,1.45875512794317,1.05611537004302,4.61693441404417,0.852912632023768,2.93130321795085,0.482428071556262,1.13590540179814,0.465873547335386,2.28618749023607,2.13495501709919,0.638849301766425,2.18964298866362,4.00260008901783,1.45040839696109,5.3143966868925,2.52873194577905,0.601473858619324,0.539135873022719],"text":["Alabama <br> share for trump 59.90%","Alaska <br> share for trump 54.20%","Arizona <br> share for trump 52.70%","Arkansas <br> share for trump 60.10%","California <br> share for trump 36.40%","Colorado <br> share for trump 45.70%","Connecticut <br> share for trump 40.30%","Delaware <br> share for trump 39.40%","District of Columbia <br> share for trump 7.40%","Florida <br> share for trump 48.30%","Georgia <br> share for trump 52.20%","Hawaii <br> share for trump 33.1%","Idaho <br> share for trump 64.10%","Illinois <br> share for trump 40.20%","Indiana <br> share for trump 53.70%","Iowa <br> share for trump 46.00%","Kansas <br> share for trump 59.40%","Kentucky <br> share for trump 60.20%","Louisiana <br> share for trump 57.10%","Maine <br> share for trump 40.70%","Maryland <br> share for trump 35.10%","Massachusetts <br> share for trump 37.20%","Michigan <br> share for trump 44.60%","Minnesota <br> share for trump 44.50%","Mississippi <br> share for trump 54.40%","Missouri <br> share for trump 53.50%","Montana <br> share for trump 55.20%","Nebraska <br> share for trump 59.30%","Nevada <br> share for trump 44.70%","New Hampshire <br> share for trump 46.30%","New Jersey <br> share for trump 39.70%","New Mexico <br> share for trump 42.20%","New York <br> share for trump 34.60%","North Carolina <br> share for trump 49.80%","North Dakota <br> share for trump 57.90%","Ohio <br> share for trump 47.40%","Oklahoma <br> share for trump 66.10%","Oregon <br> share for trump 41.80%","Pennsylvania <br> share for trump 46.30%","Rhode Island <br> share for trump 35.10%","South Carolina <br> share for trump 54.50%","South Dakota <br> share for trump 57.40%","Tennessee <br> share for trump 59.00%","Texas <br> share for trump 56.10%","Utah <br> share for trump 72.10%","Vermont <br> share for trump 31.10%","Virginia <br> share for trump 46.60%","Washington <br> share for trump 40.90%","West Virginia <br> share for trump 62.00%","Wisconsin <br> share for trump 45.60%","Wyoming <br> share for trump 67.80%"],"locations":["AL","AK","AZ","AR","CA","CO","CT","DE","DC","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],"marker":{"line":{"colorbar":{"title":"","ticklen":2},"cmin":0,"cmax":16.8827165024884,"colorscale":[["0","rgba(255,245,240,1)"],["0.0276381501808651","rgba(255,240,233,1)"],["0.0291350844947359","rgba(255,240,233,1)"],["0.0331604121426014","rgba(255,239,232,1)"],["0.0368979147901257","rgba(255,239,231,1)"],["0.0462814299368298","rgba(255,237,229,1)"],["0.0578460434229595","rgba(255,235,226,1)"],["0.0656081980995609","rgba(255,234,224,1)"],["0.0781357869275092","rgba(255,232,221,1)"],["0.0848442765868411","rgba(255,231,220,1)"],["0.0863228382646843","rgba(255,230,219,1)"],["0.0928963955658705","rgba(254,229,218,1)"],["0.0994352614608665","rgba(254,228,216,1)"],["0.112143104206994","rgba(254,226,213,1)"],["0.126997908109786","rgba(254,223,209,1)"],["0.13139983231937","rgba(254,222,207,1)"],["0.137574915231338","rgba(254,220,205,1)"],["0.154340895505053","rgba(254,215,198,1)"],["0.174590813352765","rgba(254,209,190,1)"],["0.178296121547066","rgba(254,208,189,1)"],["0.194468249085437","rgba(254,203,183,1)"],["0.239264076066464","rgba(252,190,165,1)"],["0.272379802797908","rgba(252,180,152,1)"],["0.311517159113247","rgba(253,167,138,1)"],["1","rgba(103,0,13,1)"]],"showscale":false,"color":"rgba(190,190,190,1)","width":1}},"type":"choropleth","geo":"geo","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
</div>
<div id="crime-rate-comparision-between-10-days-after-election-and-2016-average." class="section level2">
<h2>crime rate comparision between 10 days after election and 2016 average.</h2>
<pre class="r"><code>library(reshape2)</code></pre>
<pre><code>## 
## Attaching package: &#39;reshape2&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     smiths</code></pre>
<pre class="r"><code>hate_crime_10days&lt;-read_csv(&quot;./data/hate_crime_10days.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   state = col_character(),
##   hate_crimes_per_100k_splc = col_double()
## )</code></pre>
<pre class="r"><code>hate_crime_ave&lt;-hate_crime %&gt;% 
  na.omit() %&gt;% 
  filter(year==2016) 


compare_rate&lt;-merge(hate_crime_10days, hate_crime_ave, by= &quot;state&quot;)

compare_rate %&gt;% 
  mutate(hate_crimes_10days = hate_crimes_per_100k_splc/10 * 365,
         hate_crimes_2016 = annualprop) %&gt;% 
  select(state, hate_crimes_10days, hate_crimes_2016) %&gt;% 
  melt(, id = &quot;state&quot;) %&gt;% 
  mutate(state = factor(state, levels = state %&gt;% unique %&gt;% sort(decreasing = T))) %&gt;% 
  mutate(state = reorder(state, value)) %&gt;% 
  ggplot(aes(x = state, y = value, fill = variable, group = variable))+
  geom_bar(stat=&quot;identity&quot;, position = &quot;dodge&quot;, width = 0.5)+
  scale_y_continuous(expand = c(0, 0), limits = c(0, 60))+
  coord_flip() +
  theme(axis.text.x = element_text(angle = 0, size = 10, hjust = 1),legend.position = &quot;right&quot;) +
  ggtitle(&quot;Hate Crime Rate Before and After Trump Election&quot;) +
  labs(y = &quot;Hate Crime Rate (per 100,000)&quot;, x = &quot;State&quot;)</code></pre>
<p><img src="final_project_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
</div>
<div id="regression-part" class="section level1">
<h1>Regression part</h1>
<div id="regression-part-1" class="section level2">
<h2>regression part</h2>
<pre class="r"><code>sum(is.na(merge_data))</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="r"><code>mle = lm(crime_rate~median_income+share_unemployed+share_population_with_high_school_degree+share_non_citizen+ share_white+ crime_rate, data = merge_data)</code></pre>
<pre><code>## Warning in model.matrix.default(mt, mf, contrasts): the response appeared
## on the right-hand side and was dropped</code></pre>
<pre><code>## Warning in model.matrix.default(mt, mf, contrasts): problem with term 6 in
## model.matrix: no columns are assigned</code></pre>
<pre class="r"><code>summary(mle)</code></pre>
<pre><code>## 
## Call:
## lm(formula = crime_rate ~ median_income + share_unemployed + 
##     share_population_with_high_school_degree + share_non_citizen + 
##     share_white + crime_rate, data = merge_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.0409 -1.1745 -0.5750  0.7245 11.7523 
## 
## Coefficients:
##                                            Estimate Std. Error t value
## (Intercept)                              -5.432e+00  1.508e+01  -0.360
## median_income                             8.688e-05  7.197e-05   1.207
## share_unemployed                          3.955e+01  5.074e+01   0.779
## share_population_with_high_school_degree  5.541e+00  2.034e+01   0.272
## share_non_citizen                        -1.571e+01  2.078e+01  -0.756
## share_white                              -4.622e+00  4.802e+00  -0.963
##                                          Pr(&gt;|t|)
## (Intercept)                                 0.720
## median_income                               0.234
## share_unemployed                            0.440
## share_population_with_high_school_degree    0.787
## share_non_citizen                           0.454
## share_white                                 0.341
## 
## Residual standard error: 2.456 on 44 degrees of freedom
## Multiple R-squared:  0.1349, Adjusted R-squared:  0.0366 
## F-statistic: 1.372 on 5 and 44 DF,  p-value: 0.2531</code></pre>
<pre class="r"><code>multi.fit = step(mle, direction = &#39;backward&#39;)</code></pre>
<pre><code>## Start:  AIC=95.47
## crime_rate ~ median_income + share_unemployed + share_population_with_high_school_degree + 
##     share_non_citizen + share_white + crime_rate</code></pre>
<pre><code>## Warning in model.matrix.default(object, data = structure(list(crime_rate =
## c(1.3808898651561, : the response appeared on the right-hand side and was
## dropped</code></pre>
<pre><code>## Warning in model.matrix.default(object, data = structure(list(crime_rate
## = c(1.3808898651561, : problem with term 6 in model.matrix: no columns are
## assigned</code></pre>
<pre><code>## 
## Step:  AIC=95.47
## crime_rate ~ median_income + share_unemployed + share_population_with_high_school_degree + 
##     share_non_citizen + share_white
## 
##                                            Df Sum of Sq    RSS    AIC
## - share_population_with_high_school_degree  1    0.4476 265.92 93.559
## - share_non_citizen                         1    3.4486 268.92 94.120
## - share_unemployed                          1    3.6656 269.14 94.160
## - share_white                               1    5.5897 271.06 94.516
## - median_income                             1    8.7930 274.27 95.104
## &lt;none&gt;                                                  265.47 95.474
## 
## Step:  AIC=93.56
## crime_rate ~ median_income + share_unemployed + share_non_citizen + 
##     share_white
## 
##                     Df Sum of Sq    RSS    AIC
## - share_unemployed   1    3.4309 269.35 92.200
## - share_non_citizen  1    4.5181 270.44 92.401
## - share_white        1    5.1956 271.12 92.526
## &lt;none&gt;                           265.92 93.559
## - median_income      1   27.7787 293.70 96.527
## 
## Step:  AIC=92.2
## crime_rate ~ median_income + share_non_citizen + share_white
## 
##                     Df Sum of Sq    RSS    AIC
## - share_non_citizen  1    7.6123 276.96 91.593
## &lt;none&gt;                           269.35 92.200
## - share_white        1   17.9088 287.26 93.418
## - median_income      1   24.5931 293.94 94.568
## 
## Step:  AIC=91.59
## crime_rate ~ median_income + share_white
## 
##                 Df Sum of Sq    RSS    AIC
## - share_white    1    10.736 287.70 91.495
## &lt;none&gt;                       276.96 91.593
## - median_income  1    17.044 294.01 92.579
## 
## Step:  AIC=91.49
## crime_rate ~ median_income
## 
##                 Df Sum of Sq    RSS    AIC
## &lt;none&gt;                       287.70 91.495
## - median_income  1    19.174 306.87 92.721</code></pre>
<pre class="r"><code>summary(multi.fit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = crime_rate ~ median_income, data = merge_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.7797 -1.3866 -0.5861  0.5338 13.6819 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)   -1.754e+00  2.325e+00  -0.754    0.454  
## median_income  6.980e-05  3.902e-05   1.789    0.080 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.448 on 48 degrees of freedom
## Multiple R-squared:  0.06248,    Adjusted R-squared:  0.04295 
## F-statistic: 3.199 on 1 and 48 DF,  p-value: 0.08</code></pre>
<pre class="r"><code># see distribution of crime rate 
merge_data %&gt;% 
  ggplot(aes(x = crime_rate)) + geom_histogram()</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="final_project_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code># transform crime rate variable
merge_data_log = merge_data %&gt;% 
  mutate(crime_rate = log(crime_rate)) 

mle_log = lm(crime_rate~median_income+share_unemployed+share_population_with_high_school_degree+share_non_citizen+ share_white, data = merge_data_log)

summary(step(mle_log, direction = &quot;both&quot;))</code></pre>
<pre><code>## Start:  AIC=-17.38
## crime_rate ~ median_income + share_unemployed + share_population_with_high_school_degree + 
##     share_non_citizen + share_white
## 
##                                            Df Sum of Sq    RSS     AIC
## - share_population_with_high_school_degree  1   0.00712 27.789 -19.369
## - share_non_citizen                         1   0.25928 28.041 -18.918
## - share_white                               1   0.55094 28.333 -18.400
## - median_income                             1   0.74481 28.527 -18.059
## - share_unemployed                          1   0.80726 28.589 -17.950
## &lt;none&gt;                                                  27.782 -17.382
## 
## Step:  AIC=-19.37
## crime_rate ~ median_income + share_unemployed + share_non_citizen + 
##     share_white
## 
##                                            Df Sum of Sq    RSS     AIC
## - share_non_citizen                         1   0.30720 28.096 -20.820
## - share_white                               1   0.58711 28.376 -20.324
## - share_unemployed                          1   0.83409 28.623 -19.891
## &lt;none&gt;                                                  27.789 -19.369
## - median_income                             1   1.47558 29.265 -18.782
## + share_population_with_high_school_degree  1   0.00712 27.782 -17.382
## 
## Step:  AIC=-20.82
## crime_rate ~ median_income + share_unemployed + share_white
## 
##                                            Df Sum of Sq    RSS     AIC
## - share_white                               1   0.28076 28.377 -22.322
## - share_unemployed                          1   0.62270 28.719 -21.724
## &lt;none&gt;                                                  28.096 -20.820
## + share_non_citizen                         1   0.30720 27.789 -19.369
## + share_population_with_high_school_degree  1   0.05504 28.041 -18.918
## - median_income                             1   2.46311 30.559 -18.618
## 
## Step:  AIC=-22.32
## crime_rate ~ median_income + share_unemployed
## 
##                                            Df Sum of Sq    RSS     AIC
## - share_unemployed                          1   0.34569 28.723 -23.717
## &lt;none&gt;                                                  28.377 -22.322
## + share_white                               1   0.28076 28.096 -20.820
## - median_income                             1   2.18417 30.561 -20.615
## + share_population_with_high_school_degree  1   0.03205 28.345 -20.379
## + share_non_citizen                         1   0.00085 28.376 -20.324
## 
## Step:  AIC=-23.72
## crime_rate ~ median_income
## 
##                                            Df Sum of Sq    RSS     AIC
## &lt;none&gt;                                                  28.723 -23.717
## - median_income                             1   1.85613 30.579 -22.586
## + share_unemployed                          1   0.34569 28.377 -22.322
## + share_non_citizen                         1   0.02462 28.698 -21.760
## + share_population_with_high_school_degree  1   0.01502 28.707 -21.743
## + share_white                               1   0.00374 28.719 -21.724</code></pre>
<pre><code>## 
## Call:
## lm(formula = crime_rate ~ median_income, data = merge_data_log)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.34328 -0.49755  0.00989  0.52203  2.02950 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)   -7.447e-01  7.347e-01  -1.014   0.3158  
## median_income  2.172e-05  1.233e-05   1.761   0.0846 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7736 on 48 degrees of freedom
## Multiple R-squared:  0.0607, Adjusted R-squared:  0.04113 
## F-statistic: 3.102 on 1 and 48 DF,  p-value: 0.08457</code></pre>
</div>
<div id="see-correlation-between-variables" class="section level2">
<h2>see correlation between variables</h2>
<pre class="r"><code>merge_data %&gt;%
  select(-state, -share_voters_voted_trump) %&gt;%
  select(crime_rate, everything()) %&gt;%
  pairs()</code></pre>
<p><img src="final_project_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="see-distribution-of-hate-crime-rate" class="section level2">
<h2>see distribution of hate crime rate</h2>
<pre class="r"><code>ggplot(merge_data, aes(x = crime_rate)) + 
  geom_density(alpha = .4, adjust = .5, color = &quot;blue&quot;)</code></pre>
<p><img src="final_project_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="see-whether-trump-rate-influence-the-model" class="section level2">
<h2>see whether Trump rate influence the model</h2>
<pre class="r"><code>merge_data_log = merge_data_log%&gt;%
  mutate(share_voters_voted_trump = sub(&quot;\\%&quot;, &quot;&quot;,share_voters_voted_trump))%&gt;%
  mutate(share_voters_voted_trump = as.numeric(share_voters_voted_trump)/100)

mle_log_1 = lm(crime_rate~median_income+share_unemployed+share_population_with_high_school_degree+share_non_citizen+ share_white+ share_voters_voted_trump, data = merge_data_log)
  
summary(step(mle_log_1, direction = &quot;both&quot;))</code></pre>
<pre><code>## Start:  AIC=-24.44
## crime_rate ~ median_income + share_unemployed + share_population_with_high_school_degree + 
##     share_non_citizen + share_white + share_voters_voted_trump
## 
##                                            Df Sum of Sq    RSS     AIC
## - share_population_with_high_school_degree  1    0.0613 23.241 -26.304
## - median_income                             1    0.0895 23.270 -26.244
## - share_non_citizen                         1    0.1421 23.322 -26.131
## - share_unemployed                          1    0.4039 23.584 -25.573
## &lt;none&gt;                                                  23.180 -24.436
## - share_white                               1    1.1517 24.332 -24.012
## - share_voters_voted_trump                  1    4.6017 27.782 -17.382
## 
## Step:  AIC=-26.3
## crime_rate ~ median_income + share_unemployed + share_non_citizen + 
##     share_white + share_voters_voted_trump
## 
##                                            Df Sum of Sq    RSS     AIC
## - median_income                             1    0.0308 23.272 -28.238
## - share_non_citizen                         1    0.2163 23.458 -27.841
## - share_unemployed                          1    0.4481 23.689 -27.349
## &lt;none&gt;                                                  23.241 -26.304
## - share_white                               1    1.1205 24.362 -25.950
## + share_population_with_high_school_degree  1    0.0613 23.180 -24.436
## - share_voters_voted_trump                  1    4.5475 27.789 -19.369
## 
## Step:  AIC=-28.24
## crime_rate ~ share_unemployed + share_non_citizen + share_white + 
##     share_voters_voted_trump
## 
##                                            Df Sum of Sq    RSS     AIC
## - share_non_citizen                         1    0.3131 23.585 -29.570
## - share_unemployed                          1    0.4176 23.690 -29.349
## &lt;none&gt;                                                  23.272 -28.238
## - share_white                               1    1.2118 24.484 -27.700
## + median_income                             1    0.0308 23.241 -26.304
## + share_population_with_high_school_degree  1    0.0026 23.270 -26.244
## - share_voters_voted_trump                  1    5.9923 29.265 -18.782
## 
## Step:  AIC=-29.57
## crime_rate ~ share_unemployed + share_white + share_voters_voted_trump
## 
##                                            Df Sum of Sq    RSS     AIC
## - share_unemployed                          1    0.2042 23.789 -31.139
## &lt;none&gt;                                                  23.585 -29.570
## - share_white                               1    1.0313 24.616 -29.430
## + share_non_citizen                         1    0.3131 23.272 -28.238
## + median_income                             1    0.1276 23.458 -27.841
## + share_population_with_high_school_degree  1    0.0008 23.584 -27.572
## - share_voters_voted_trump                  1    6.9740 30.559 -18.618
## 
## Step:  AIC=-31.14
## crime_rate ~ share_white + share_voters_voted_trump
## 
##                                            Df Sum of Sq    RSS     AIC
## - share_white                               1    0.8458 24.635 -31.392
## &lt;none&gt;                                                  23.789 -31.139
## + share_unemployed                          1    0.2042 23.585 -29.570
## + share_non_citizen                         1    0.0997 23.690 -29.349
## + share_population_with_high_school_degree  1    0.0303 23.759 -29.203
## + median_income                             1    0.0178 23.772 -29.177
## - share_voters_voted_trump                  1    6.7878 30.577 -20.588
## 
## Step:  AIC=-31.39
## crime_rate ~ share_voters_voted_trump
## 
##                                            Df Sum of Sq    RSS     AIC
## &lt;none&gt;                                                  24.635 -31.392
## + share_white                               1    0.8458 23.789 -31.139
## + share_population_with_high_school_degree  1    0.2158 24.419 -29.832
## + share_non_citizen                         1    0.1420 24.493 -29.681
## + median_income                             1    0.0595 24.576 -29.513
## + share_unemployed                          1    0.0187 24.616 -29.430
## - share_voters_voted_trump                  1    5.9435 30.579 -22.586</code></pre>
<pre><code>## 
## Call:
## lm(formula = crime_rate ~ share_voters_voted_trump, data = merge_data_log)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.4448 -0.4594  0.1266  0.5046  1.3476 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                2.0337     0.4519   4.500 4.32e-05 ***
## share_voters_voted_trump  -3.0629     0.9000  -3.403  0.00135 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7164 on 48 degrees of freedom
## Multiple R-squared:  0.1944, Adjusted R-squared:  0.1776 
## F-statistic: 11.58 on 1 and 48 DF,  p-value: 0.001353</code></pre>
<pre class="r"><code>##see the correlation between trump and income
cor(merge_data_log$share_voters_voted_trump, merge_data_log$median_income)</code></pre>
<pre><code>## [1] -0.4705399</code></pre>
<div id="the-final-model-1-crimeincome" class="section level3">
<h3>the final model 1 crime&amp;income</h3>
<pre class="r"><code>crime_income_slr =lm(crime_rate~median_income, data = merge_data_log)
summary(crime_income_slr)%&gt;%
  broom::tidy()%&gt;%
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-0.7447166</td>
<td align="right">0.7347082</td>
<td align="right">-1.013622</td>
<td align="right">0.3158453</td>
</tr>
<tr class="even">
<td align="left">median_income</td>
<td align="right">0.0000217</td>
<td align="right">0.0000123</td>
<td align="right">1.761218</td>
<td align="right">0.0845705</td>
</tr>
</tbody>
</table>
</div>
<div id="the-final-model-2-crimetrumpincome" class="section level3">
<h3>the final model 2 crime~Trump&amp;income</h3>
<pre class="r"><code>crime_trump_slr = lm(crime_rate~share_voters_voted_trump, data = merge_data_log)
summary(crime_trump_slr)%&gt;%
  broom::tidy()%&gt;%
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">2.033682</td>
<td align="right">0.4519470</td>
<td align="right">4.499824</td>
<td align="right">0.0000432</td>
</tr>
<tr class="even">
<td align="left">share_voters_voted_trump</td>
<td align="right">-3.062861</td>
<td align="right">0.9000421</td>
<td align="right">-3.403020</td>
<td align="right">0.0013531</td>
</tr>
</tbody>
</table>
</div>
<div id="the-final-model-3-crimetrumpincome" class="section level3">
<h3>the final model 3 crime&amp;Trump&amp;income</h3>
<pre class="r"><code>mlr_trump_income = lm(crime_rate~share_voters_voted_trump + median_income, data = merge_data_log)
summary(mlr_trump_income)%&gt;%
  broom::tidy()%&gt;%
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.6940485</td>
<td align="right">1.1052713</td>
<td align="right">1.5326993</td>
<td align="right">0.1320542</td>
</tr>
<tr class="even">
<td align="left">share_voters_voted_trump</td>
<td align="right">-2.8994265</td>
<td align="right">1.0295662</td>
<td align="right">-2.8161633</td>
<td align="right">0.0070822</td>
</tr>
<tr class="odd">
<td align="left">median_income</td>
<td align="right">0.0000044</td>
<td align="right">0.0000131</td>
<td align="right">0.3373593</td>
<td align="right">0.7373481</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="do-scatter-plot" class="section level2">
<h2>do scatter plot</h2>
<pre class="r"><code>merge_data_log%&gt;%
  ggplot(aes(x = median_income,y = crime_rate))+
  geom_smooth(method = &quot;lm&quot;, color=&quot;black&quot;, formula = y ~ x) +
  geom_point()</code></pre>
<p><img src="final_project_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<pre class="r"><code>merge_data_log%&gt;%
  ggplot(aes(x = share_voters_voted_trump, y = crime_rate))+
  geom_smooth(method = &quot;lm&quot;, color=&quot;black&quot;, formula = y ~ x) +
  geom_point()</code></pre>
<p><img src="final_project_files/figure-html/unnamed-chunk-16-2.png" width="672" /></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
